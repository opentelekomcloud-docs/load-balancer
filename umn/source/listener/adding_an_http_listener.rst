:original_name: elb_ug_jt_0008.html

.. _elb_ug_jt_0008:

Adding an HTTP Listener
=======================

Scenarios
---------

HTTP listeners are suitable for applications that require identifying the data content, such as web applications and small mobile games.

Constraints
-----------

-  If the listener protocol is HTTP, the protocol of the backend server group is HTTP by default and cannot be changed.
-  If you only select network load balancing (TCP/UDP) for your dedicated load balancer, you cannot add an HTTP listener to this load balancer.

Adding an HTTP Listener to a Dedicated Load Balancer
----------------------------------------------------

#. Log in to the management console.

#. In the upper left corner of the page, click |image1| and select the desired region and project.

#. Click |image2| in the upper left corner to display **Service List** and choose **Network** > **Elastic Load Balancing**.

#. Locate the load balancer and click its name.

#. Under **Listeners**, click **Add Listener**. Configure the parameters based on :ref:`Table 1 <elb_ug_jt_0008__table16995152202318>`.

   .. _elb_ug_jt_0008__table16995152202318:

   .. table:: **Table 1** Parameters for configuring a listener

      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter                  | Description                                                                                                                                                                                                                                                                                                                           | Example Value         |
      +============================+=======================================================================================================================================================================================================================================================================================================================================+=======================+
      | Name                       | Specifies the listener name.                                                                                                                                                                                                                                                                                                          | listener              |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Frontend Protocol          | Specifies the protocol that will be used by the load balancer to receive requests from clients.                                                                                                                                                                                                                                       | HTTP                  |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Frontend Port              | Specifies the port that will be used by the load balancer to receive requests from clients.                                                                                                                                                                                                                                           | 80                    |
      |                            |                                                                                                                                                                                                                                                                                                                                       |                       |
      |                            | The port number ranges from 1 to 65535.                                                                                                                                                                                                                                                                                               |                       |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Redirect                   | Specifies whether to enable redirection.                                                                                                                                                                                                                                                                                              | N/A                   |
      |                            |                                                                                                                                                                                                                                                                                                                                       |                       |
      |                            | If you have both HTTPS and HTTP listeners, you can use this function to redirect the requests from the HTTP listener to the HTTPS listener to ensure security.                                                                                                                                                                        |                       |
      |                            |                                                                                                                                                                                                                                                                                                                                       |                       |
      |                            | If you create a redirect for an HTTP listener, the backend server will return HTTP 301 Move Permanently to the clients.                                                                                                                                                                                                               |                       |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Redirected To              | Specifies the HTTPS listener to which requests are redirected.                                                                                                                                                                                                                                                                        | listener_HTTPS_443    |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Access Control             | Specifies how access to the listener is controlled. The following options are available (for details, see :ref:`Access Control <elb_03_0003>`):                                                                                                                                                                                       | **Blacklist**         |
      |                            |                                                                                                                                                                                                                                                                                                                                       |                       |
      |                            | -  **All IP addresses**                                                                                                                                                                                                                                                                                                               |                       |
      |                            | -  **Blacklist**                                                                                                                                                                                                                                                                                                                      |                       |
      |                            | -  **Whitelist**                                                                                                                                                                                                                                                                                                                      |                       |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | IP Address Group           | Specifies the IP address group associated with a whitelist or blacklist. If there is no IP address group, create one first. For more information, see :ref:`Creating an IP Address Group <elb_ug_ip_0000>`.                                                                                                                           | ipGroup               |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Transfer Client IP Address | Specifies whether to transmit IP addresses of the clients to backend servers.                                                                                                                                                                                                                                                         | Enabled               |
      |                            |                                                                                                                                                                                                                                                                                                                                       |                       |
      |                            | This function is enabled for dedicated load balancers by default and cannot be disabled.                                                                                                                                                                                                                                              |                       |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | **Advanced Settings**      |                                                                                                                                                                                                                                                                                                                                       |                       |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Transfer Load Balancer EIP | Specifies whether to store the EIP bound to the load balancer in the X-Forwarded-ELB-IP header field and pass this field to backend servers.                                                                                                                                                                                          | N/A                   |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Idle Timeout               | Specifies the length of time for a connection to keep alive, in seconds. If no request is received within this period, the load balancer closes the connection and establishes a new one with the client when the next request arrives.                                                                                               | 60                    |
      |                            |                                                                                                                                                                                                                                                                                                                                       |                       |
      |                            | The idle timeout duration ranges from **0** to **4000**.                                                                                                                                                                                                                                                                              |                       |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Request Timeout            | Specifies the length of time (in seconds) after which the load balancer closes the connection if the load balancer does not receive a request from the client.                                                                                                                                                                        | 60                    |
      |                            |                                                                                                                                                                                                                                                                                                                                       |                       |
      |                            | The request timeout duration ranges from **1** to **300**.                                                                                                                                                                                                                                                                            |                       |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Response Timeout           | Specifies the length of time (in seconds) after which the load balancer sends a 504 Gateway Timeout error to the client if the load balancer receives no response from the backend server after routing a request to the backend server and receives no response after attempting to route the same request to other backend servers. | 60                    |
      |                            |                                                                                                                                                                                                                                                                                                                                       |                       |
      |                            | The response timeout duration ranges from **1** to **300**.                                                                                                                                                                                                                                                                           |                       |
      |                            |                                                                                                                                                                                                                                                                                                                                       |                       |
      |                            | .. note::                                                                                                                                                                                                                                                                                                                             |                       |
      |                            |                                                                                                                                                                                                                                                                                                                                       |                       |
      |                            |    If you have enabled sticky sessions and the backend server does not respond within the response timeout duration, the load balancer returns 504 Gateway Timeout to the clients.                                                                                                                                                    |                       |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Tag                        | Adds tags to the listener. Each tag is a key-value pair, and the tag key is unique.                                                                                                                                                                                                                                                   | N/A                   |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Description                | Provides supplementary information about the listener.                                                                                                                                                                                                                                                                                | N/A                   |
      |                            |                                                                                                                                                                                                                                                                                                                                       |                       |
      |                            | You can enter a maximum of 255 characters.                                                                                                                                                                                                                                                                                            |                       |
      +----------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next: Configure Request Routing Policy**.

   a. You are advised to select an existing backend server group.
   b. You can also click **Create new** to create a backend server group and configure parameters as described in :ref:`Table 2 <elb_ug_jt_0008__table299811529239>`.

   .. _elb_ug_jt_0008__table299811529239:

   .. table:: **Table 2** Parameters for configuring a backend server group

      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter                 | Description                                                                                                                                                                                                                                                                                                                                                                                                                                | Example Value         |
      +===========================+============================================================================================================================================================================================================================================================================================================================================================================================================================================+=======================+
      | Backend Server Group      | Specifies a group of servers with the same features to receive requests from the load balancer. Two options are available:                                                                                                                                                                                                                                                                                                                 | Create new            |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  **Create new**                                                                                                                                                                                                                                                                                                                                                                                                                          |                       |
      |                           | -  **Use existing**                                                                                                                                                                                                                                                                                                                                                                                                                        |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |    .. note::                                                                                                                                                                                                                                                                                                                                                                                                                               |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |       To associate an existing backend server group, ensure that it is not in use. Select the backend server group with the correct protocol. For example, if the frontend protocol is TCP, the backend protocol must be TCP.                                                                                                                                                                                                              |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Backend Server Group Name | Specifies the name of the backend server group.                                                                                                                                                                                                                                                                                                                                                                                            | server_group          |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Backend Protocol          | Specifies the protocol that will be used by backend servers to receive requests.                                                                                                                                                                                                                                                                                                                                                           | HTTP                  |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | The backend protocol is HTTP by default and cannot be changed.                                                                                                                                                                                                                                                                                                                                                                             |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Load Balancing Algorithm  | Specifies the algorithm that will be used by the load balancer to distribute traffic. The following options are available:                                                                                                                                                                                                                                                                                                                 | Weighted round robin  |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  **Weighted round robin**: Requests are routed to different servers based on their weights, which indicate server processing performance. Backend servers with higher weights receive proportionately more requests, whereas equal-weighted servers receive the same number of requests.                                                                                                                                                 |                       |
      |                           | -  **Weighted least connections**: In addition to the number of active connections established with each backend server, each server is assigned a weight based on their processing capability. Requests are routed to the server with the lowest connections-to-weight ratio.                                                                                                                                                             |                       |
      |                           | -  **Source IP hash**: The source IP address of each request is calculated using the consistent hashing algorithm to obtain a unique hash key, and all backend servers are numbered. The generated key is used to allocate the client to a particular server. This allows requests from different clients to be routed based on source IP addresses and ensures that a client is directed to the same server that it was using previously. |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                  |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |    -  Choose an appropriate algorithm based on your requirements for better traffic distribution.                                                                                                                                                                                                                                                                                                                                          |                       |
      |                           |    -  For **Weighted round robin** or **Weighted least connections**, no requests will be routed to a server with a weight of 0.                                                                                                                                                                                                                                                                                                           |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Sticky Session            | Specifies whether to enable sticky sessions. If you enable sticky sessions, all requests from a client during one session are sent to the same backend server. This parameter is optional and can be enabled only if you have selected **Weighted round robin** for **Load Balancing Algorithm**.                                                                                                                                          | N/A                   |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Sticky Session Type       | Specifies the type of sticky sessions for HTTP and HTTPS listeners.                                                                                                                                                                                                                                                                                                                                                                        | Load balancer cookie  |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  **Load balancer cookie**: The load balancer generates a cookie after receiving a request from the client. All subsequent requests with the same cookie are routed to the same backend server.                                                                                                                                                                                                                                           |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Stickiness Duration (min) | Specifies the minutes that sticky sessions are maintained. You can enable sticky sessions only if you select **Weighted round robin** for **Load Balancing Algorithm**.                                                                                                                                                                                                                                                                    | 20                    |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  Stickiness duration at Layer 4: **1** to **60**                                                                                                                                                                                                                                                                                                                                                                                         |                       |
      |                           | -  Stickiness duration at Layer 7: **1** to **1440**                                                                                                                                                                                                                                                                                                                                                                                       |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Slow Start                | Specifies whether to enable slow start, which is disabled by default.                                                                                                                                                                                                                                                                                                                                                                      | N/A                   |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | After you enable slow start, the load balancer linearly increases the proportion of requests to send to backend servers in this mode. When the slow start duration elapses, the load balancer sends full share of requests to backend servers and exits the slow start mode.                                                                                                                                                               |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | For details, see :ref:`Slow Start (Dedicated Load Balancers) <en-us_topic_0000001794819209>`.                                                                                                                                                                                                                                                                                                                                              |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Slow Start Duration       | Specifies how long the slow start will last.                                                                                                                                                                                                                                                                                                                                                                                               | 30                    |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | The duration ranges from **30** to **1200**, in seconds, and the default value is **30**.                                                                                                                                                                                                                                                                                                                                                  |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Description               | Provides supplementary information about the backend server group.                                                                                                                                                                                                                                                                                                                                                                         | N/A                   |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | You can enter a maximum of 255 characters.                                                                                                                                                                                                                                                                                                                                                                                                 |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next: Add Backend Server**. Add backend servers and configure health check for the backend server group. For details about how to add backend servers, see :ref:`Overview <elb_ug_hd3_0001>`. For details about how to configure health check parameters, see :ref:`Table 3 <elb_ug_jt_0008__table078741801812>`.

   .. _elb_ug_jt_0008__table078741801812:

   .. table:: **Table 3** Parameters for configuring a health check

      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter             | Description                                                                                                                                                                                                                                                       | Example Value         |
      +=======================+===================================================================================================================================================================================================================================================================+=======================+
      | Health Check          | Specifies whether to enable health checks.                                                                                                                                                                                                                        | N/A                   |
      |                       |                                                                                                                                                                                                                                                                   |                       |
      |                       | If the health check is enabled, click |image3| next to **Advanced Settings** to set health check parameters.                                                                                                                                                      |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Advanced Settings     |                                                                                                                                                                                                                                                                   |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Health Check Protocol | Specifies the protocol that will be used by the load balancer to check the health of backend servers. There are three options: TCP, HTTP, and HTTPS.                                                                                                              | HTTP                  |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Domain Name           | Specifies the domain name that will be used for health checks. This parameter is available when you set the health check protocol to HTTP or HTTPS.                                                                                                               | www.elb.com           |
      |                       |                                                                                                                                                                                                                                                                   |                       |
      |                       | The domain name can contain digits, letters, hyphens (-), and periods (.), and must start with a digit or letter. The field is left blank by default and must start with a digit or letter.                                                                       |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Health Check Port     | Specifies the port that will be used by the load balancer to check the health of backend servers. The port number ranges from 1 to 65535.                                                                                                                         | 80                    |
      |                       |                                                                                                                                                                                                                                                                   |                       |
      |                       | .. note::                                                                                                                                                                                                                                                         |                       |
      |                       |                                                                                                                                                                                                                                                                   |                       |
      |                       |    This parameter is optional. If you do not specify a health check port, a port of the backend server will be used for health checks by default. If you specify a port, it will be used for health checks.                                                       |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Path                  | Specifies the health check URL, which is the destination on backend servers for health checks. This parameter is available only when you set the health check protocol to HTTP or HTTPS. The path must start with a slash (/) and can contain 1 to 80 characters. | /index.html           |
      |                       |                                                                                                                                                                                                                                                                   |                       |
      |                       | The path can contain letters, digits, hyphens (-), slashes (/), periods (.), percent signs (%), ampersands (&), and the following special characters: ``_~';@$*+,=!:()``                                                                                          |                       |
      |                       |                                                                                                                                                                                                                                                                   |                       |
      |                       | .. note::                                                                                                                                                                                                                                                         |                       |
      |                       |                                                                                                                                                                                                                                                                   |                       |
      |                       |    Example:                                                                                                                                                                                                                                                       |                       |
      |                       |                                                                                                                                                                                                                                                                   |                       |
      |                       |    If the URL is **http://www.example.com/chat/try/**, the health check path is **/chat/try/**.                                                                                                                                                                   |                       |
      |                       |                                                                                                                                                                                                                                                                   |                       |
      |                       |    If the URL is **http://192.168.63.187:9096/chat/index.html**, the health check path is **/chat/index.html**.                                                                                                                                                   |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Interval (s)          | Specifies the maximum time between two consecutive health checks, in seconds.                                                                                                                                                                                     | 5                     |
      |                       |                                                                                                                                                                                                                                                                   |                       |
      |                       | The interval ranges from **1** to **50**.                                                                                                                                                                                                                         |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Timeout (s)           | Specifies the maximum time required for waiting for a response from the health check, in seconds. The timeout duration ranges from **1** to **50**.                                                                                                               | 3                     |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Maximum Retries       | Specifies the maximum number of health check retries. The value ranges from **1** to **10**.                                                                                                                                                                      | 3                     |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next: Confirm**.

#. Confirm the configuration and click **Submit**.

Adding an HTTP Listener to a Shared Load Balancer
-------------------------------------------------

#. Log in to the management console.

#. In the upper left corner of the page, click |image4| and select the desired region and project.

#. Click |image5| in the upper left corner to display **Service List** and choose **Network** > **Elastic Load Balancing**.

#. Locate the load balancer and click its name.

#. Under **Listeners**, click **Add Listener**. Configure the parameters based on :ref:`Table 4 <elb_ug_jt_0008__table20377204713512>`.

   .. _elb_ug_jt_0008__table20377204713512:

   .. table:: **Table 4** Parameters for configuring a listener for a shared enhanced load balancer

      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Parameter                  | Description                                                                                                                                                                                                                                                                                                 | Example Value             |
      +============================+=============================================================================================================================================================================================================================================================================================================+===========================+
      | Name                       | Specifies the listener name.                                                                                                                                                                                                                                                                                | listener                  |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Frontend Protocol          | Specifies the protocol that will be used by the load balancer to receive requests from clients.                                                                                                                                                                                                             | HTTP                      |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Frontend Port              | Specifies the port that will be used by the load balancer to receive requests from clients.                                                                                                                                                                                                                 | 80                        |
      |                            |                                                                                                                                                                                                                                                                                                             |                           |
      |                            | The port number ranges from 1 to 65535.                                                                                                                                                                                                                                                                     |                           |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Redirect                   | Specifies whether to enable redirection.                                                                                                                                                                                                                                                                    | N/A                       |
      |                            |                                                                                                                                                                                                                                                                                                             |                           |
      |                            | Redirects requests to an HTTPS listener when HTTP is used as the frontend protocol. If you have both HTTPS and HTTP listeners, you can use this function to redirect the requests from the HTTP listener to the HTTPS listener to ensure security.                                                          |                           |
      |                            |                                                                                                                                                                                                                                                                                                             |                           |
      |                            | If you create a redirect for an HTTP listener, the backend server will return HTTP 301 Move Permanently to the clients.                                                                                                                                                                                     |                           |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Redirected To              | Specifies the HTTPS listener to which requests are redirected.                                                                                                                                                                                                                                              | listener-9ecd (HTTPS/443) |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Access Control             | Specifies how access to the listener is controlled. The following options are available (for details, see :ref:`Access Control <elb_03_0003>`):                                                                                                                                                             | Whitelist                 |
      |                            |                                                                                                                                                                                                                                                                                                             |                           |
      |                            | -  **All IP addresses**                                                                                                                                                                                                                                                                                     |                           |
      |                            | -  **Blacklist**                                                                                                                                                                                                                                                                                            |                           |
      |                            | -  **Whitelist**                                                                                                                                                                                                                                                                                            |                           |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | IP Address Group           | Specifies the IP address group associated with a whitelist or blacklist. If there is no IP address group, create one first. For more information, see :ref:`Creating an IP Address Group <elb_ug_ip_0000>`.                                                                                                 | ipGroup-b2                |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Transfer Client IP Address | Specifies whether to transmit IP addresses of the clients to backend servers.                                                                                                                                                                                                                               | Enabled                   |
      |                            |                                                                                                                                                                                                                                                                                                             |                           |
      |                            | This function is enabled by default and cannot be disabled.                                                                                                                                                                                                                                                 |                           |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | **Advanced Settings**      |                                                                                                                                                                                                                                                                                                             |                           |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Transfer Load Balancer EIP | Specifies whether to store the EIP bound to the load balancer in the X-Forwarded-ELB-IP header field and pass this field to backend servers.                                                                                                                                                                | N/A                       |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Idle Timeout               | Specifies the length of time for a connection to keep alive, in seconds. If no request is received within this period, the load balancer closes the connection and establishes a new one with the client when the next request arrives.                                                                     | 60                        |
      |                            |                                                                                                                                                                                                                                                                                                             |                           |
      |                            | The idle timeout duration ranges from **0** to **4000**.                                                                                                                                                                                                                                                    |                           |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Request Timeout            | Specifies the length of time (in seconds) after which the load balancer closes the connection if the load balancer does not receive a request from the client.                                                                                                                                              | 60                        |
      |                            |                                                                                                                                                                                                                                                                                                             |                           |
      |                            | The request timeout duration ranges from **1** to **300**.                                                                                                                                                                                                                                                  |                           |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Response Timeout           | A load balancer sends a request to a backend server. If the backend server does not respond within the timeout period, the load balancer sends the request to another backend server. If the backend server does not respond during the retry, the load balancer returns error code HTTP 504 to the client. | 60                        |
      |                            |                                                                                                                                                                                                                                                                                                             |                           |
      |                            | The request timeout duration ranges from **1** to **300**.                                                                                                                                                                                                                                                  |                           |
      |                            |                                                                                                                                                                                                                                                                                                             |                           |
      |                            | .. note::                                                                                                                                                                                                                                                                                                   |                           |
      |                            |                                                                                                                                                                                                                                                                                                             |                           |
      |                            |    If you have enabled sticky sessions and the backend server does not respond within the response timeout duration, the load balancer returns 504 Gateway Timeout to the clients.                                                                                                                          |                           |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Tag                        | Adds tags to the listener. Each tag is a key-value pair, and the tag key is unique.                                                                                                                                                                                                                         | N/A                       |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+
      | Description                | Provides supplementary information about the listener.                                                                                                                                                                                                                                                      | N/A                       |
      |                            |                                                                                                                                                                                                                                                                                                             |                           |
      |                            | You can enter a maximum of 255 characters.                                                                                                                                                                                                                                                                  |                           |
      +----------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------+

#. Click **Next: Configure Request Routing Policy**. :ref:`Table 5 <elb_ug_jt_0008__table3561446373>` describes the parameters for configuring a backend server group.

   .. _elb_ug_jt_0008__table3561446373:

   .. table:: **Table 5** Parameters for adding a backend server group

      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter                 | Description                                                                                                                                                                                                                                                                                                                                                                                                                                | Example Value         |
      +===========================+============================================================================================================================================================================================================================================================================================================================================================================================================================================+=======================+
      | Backend Server Group      | Specifies a group of servers with the same features to receive requests from the load balancer. Two options are available:                                                                                                                                                                                                                                                                                                                 | **Create new**        |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  **Create new**                                                                                                                                                                                                                                                                                                                                                                                                                          |                       |
      |                           | -  **Use existing**                                                                                                                                                                                                                                                                                                                                                                                                                        |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |    .. note::                                                                                                                                                                                                                                                                                                                                                                                                                               |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |       To associate an existing backend server group, ensure that it is not in use. Select the backend server group with the correct protocol. For example, if the frontend protocol is TCP, the backend protocol must be TCP.                                                                                                                                                                                                              |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Backend Server Group Name | Specifies the name of the backend server group.                                                                                                                                                                                                                                                                                                                                                                                            | server_group          |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Backend Protocol          | Specifies the protocol that will be used by backend servers to receive requests.                                                                                                                                                                                                                                                                                                                                                           | HTTP                  |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | The backend protocol is HTTP by default and cannot be changed.                                                                                                                                                                                                                                                                                                                                                                             |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Load Balancing Algorithm  | Specifies the algorithm that will be used by the load balancer to distribute traffic. The following options are available:                                                                                                                                                                                                                                                                                                                 | Weighted round robin  |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  **Weighted round robin**: Requests are routed to different servers based on their weights, which indicate server processing performance. Backend servers with higher weights receive proportionately more requests, whereas equal-weighted servers receive the same number of requests.                                                                                                                                                 |                       |
      |                           | -  **Weighted least connections**: In addition to the number of active connections established with each backend server, each server is assigned a weight based on their processing capability. Requests are routed to the server with the lowest connections-to-weight ratio.                                                                                                                                                             |                       |
      |                           | -  **Source IP hash**: The source IP address of each request is calculated using the consistent hashing algorithm to obtain a unique hash key, and all backend servers are numbered. The generated key is used to allocate the client to a particular server. This allows requests from different clients to be routed based on source IP addresses and ensures that a client is directed to the same server that it was using previously. |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                  |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |    -  Choose an appropriate algorithm based on your requirements for better traffic distribution.                                                                                                                                                                                                                                                                                                                                          |                       |
      |                           |    -  For **Weighted round robin** or **Weighted least connections**, no requests will be routed to a server with a weight of 0.                                                                                                                                                                                                                                                                                                           |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Sticky Session            | Specifies whether to enable sticky sessions. If you enable sticky sessions, all requests from a client during one session are sent to the same backend server.                                                                                                                                                                                                                                                                             | N/A                   |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                  |                       |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           |    You can enable sticky sessions only if you have selected **Weighted round robin** for **Load Balancing Algorithm**.                                                                                                                                                                                                                                                                                                                     |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Sticky Session Type       | Specifies the type of sticky sessions for HTTP and HTTPS listeners.                                                                                                                                                                                                                                                                                                                                                                        | Load balancer cookie  |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  **Load balancer cookie**: The load balancer generates a cookie after receiving a request from the client.                                                                                                                                                                                                                                                                                                                               |                       |
      |                           | -  **Application cookie**: The application deployed on the backend server generates a cookie after receiving the first request from the client. All subsequent requests with the same cookie are routed to the same backend server.                                                                                                                                                                                                        |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Cookie Name               | Specifies the cookie name. If you select **Application cookie**, enter a cookie name.                                                                                                                                                                                                                                                                                                                                                      | cookieName-qsps       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Stickiness Duration (min) | Specifies the minutes that sticky sessions are maintained. You can enable sticky sessions only if you select **Weighted round robin** for **Load Balancing Algorithm**.                                                                                                                                                                                                                                                                    | 20                    |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | -  Stickiness duration at Layer 4: **1** to **60**                                                                                                                                                                                                                                                                                                                                                                                         |                       |
      |                           | -  Stickiness duration at Layer 7: **1** to **1440**                                                                                                                                                                                                                                                                                                                                                                                       |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Description               | Provides supplementary information about the backend server group.                                                                                                                                                                                                                                                                                                                                                                         | N/A                   |
      |                           |                                                                                                                                                                                                                                                                                                                                                                                                                                            |                       |
      |                           | You can enter a maximum of 255 characters.                                                                                                                                                                                                                                                                                                                                                                                                 |                       |
      +---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next: Add Backend Server**. Add backend servers and configure health check for the backend server group. For details about how to add backend servers, see :ref:`Overview <elb_ug_hd2_0001>`. For details about how to configure health check parameters, see :ref:`Table 6 <elb_ug_jt_0008__table29561432102012>`.

   .. _elb_ug_jt_0008__table29561432102012:

   .. table:: **Table 6** Parameters for configuring a health check

      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Parameter             | Description                                                                                                                                                                                                                                     | Example Value         |
      +=======================+=================================================================================================================================================================================================================================================+=======================+
      | Health Check          | Specifies whether to enable health checks.                                                                                                                                                                                                      | N/A                   |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | If the health check is enabled, click |image6| next to **Advanced Settings** to set health check parameters.                                                                                                                                    |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Advanced Settings     |                                                                                                                                                                                                                                                 |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Health Check Protocol | Specifies the protocol that will be used by the load balancer to check the health of backend servers. There are two options: TCP and HTTP.                                                                                                      | HTTP                  |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Domain Name           | Specifies the domain name that will be used for health checks. This parameter is available when you set the health check protocol to HTTP.                                                                                                      | www.elb.com           |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | -  You can use the private IP address of the backend server as the domain name.                                                                                                                                                                 |                       |
      |                       | -  You can also specify a domain name that consists of at least two labels separated by periods (.). Use only letters, digits, and hyphens (-). Do not start or end strings with a hyphen. Max total: 100 characters. Max label: 63 characters. |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Health Check Port     | Specifies the port that will be used by the load balancer to check the health of backend servers. The port number ranges from **1** to **65535**.                                                                                               | 80                    |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | .. note::                                                                                                                                                                                                                                       |                       |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       |    By default, the service port on each backend server is used. You can also specify a port for health checks.                                                                                                                                  |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Path                  | Specifies the health check URL, which is the destination on backend servers for health checks. This parameter is mandatory if the health check protocol is HTTP.                                                                                | /index.html           |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | The path can contain 1 to 80 characters and must start with a slash (/).                                                                                                                                                                        |                       |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | The path can contain letters, digits, hyphens (-), slashes (/), periods (.), question marks (?), percent signs (%), ampersands (&), and underscores (_).                                                                                        |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Interval (s)          | Specifies the interval for sending health check requests, in seconds.                                                                                                                                                                           | 5                     |
      |                       |                                                                                                                                                                                                                                                 |                       |
      |                       | The interval ranges from **1** to **50**.                                                                                                                                                                                                       |                       |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Timeout (s)           | Specifies the maximum time required for waiting for a response from the health check, in seconds. The timeout duration ranges from **1** to **50**.                                                                                             | 3                     |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+
      | Maximum Retries       | Specifies the maximum number of health check retries. The value ranges from **1** to **10**.                                                                                                                                                    | 3                     |
      +-----------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+

#. Click **Next: Confirm**.

#. Confirm the configuration and click **Submit**.

.. |image1| image:: /_static/images/en-us_image_0000001747739624.png
.. |image2| image:: /_static/images/en-us_image_0000001794660485.png
.. |image3| image:: /_static/images/en-us_image_0000001810192678.png
.. |image4| image:: /_static/images/en-us_image_0000001747739624.png
.. |image5| image:: /_static/images/en-us_image_0000001794660485.png
.. |image6| image:: /_static/images/en-us_image_0000001747739732.png
